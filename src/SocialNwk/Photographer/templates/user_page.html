{% extends "base.html" %}
{% load staticfiles %}
{% block title %}{{ user_data.username }}{% endblock %}
{% block head_script %}
    <!--<link href="{% static 'tuolei.css' %}" rel="stylesheet">-->
    <link href="{% static 'css/user_page.css' %}" rel="stylesheet" type="text/css">
{% endblock %}
{% block content %}
    <div id="head">

        <div class="nameimg">
            <a><img id="userhead"/>
            <h4 id="photo_author"> {{ user_data.username }}</a></h4>

            {% if not me %}
            <button id="unfollow">Unfollow</button>
            <button id="follow">Follow</button>
            {% endif %}

            {% if me %}
            <a class="btn btn-primary" id="chech_follow" href="" role="button">Check Follow</a>    
            {% endif %}



        </div>

        <div class="userinfo">
            <h4 class="fav" id="name">Name: </h4>
            <h6 class="fav" id="gender">Gender: </h6>
            <h6 class="fav" id="career">Career: </h6>
            <h6 class="fav" id="about">About: </h6>
            <h6 class="fav" id="home_page">Home page: </h6>


            {% if me %}
            <a class="btn btn-default" id="edit_profile" href="{% url 'photo:edit_profile' %}" role="button">Edit Profile</a>
            {% endif %}

        </div>

        <div class="userfav">
            <h4 class="fav" id="fav_make">Favorite Make: </h4>
            <h4 class="fav" id="fav_model">Favorite Model: </h4>
            <h4 class="fav" id="fav_category">Favorite Category: </h4>
        </div>
    </div>


    <div id="container">
        <div id="main" role="main">
            <ul id="tiles">
            <!-- Place content loaded photo from the photo API -->
            </ul>
        </div>
    </div>

    <div id="loadMore"><a>Load More</a></div>

{% endblock %}

{% block foot_script %}
<script src="{% static 'tuolei.js' %}"></script>
<script>
    photo_list_url = "{% url 'photo:photo-list' %}?author="+{{ pk }};
    
    //find current user
    current_user_url = "/api/users/"+ {{ pk }};
    //current_user_url = current_user_url.substring(0, current_user_url.length - 2) + {{ pk }};
    console.log("url:"+current_user_url);
    //loadUser();

    var options = {
        autoResize: true, // This will auto-update the layout when the browser window is resized.
        container: $('#tiles'), // Optional, used for some extra CSS styling
        offset: 2, // Optional, the distance between grid items
        itemWidth: 210, // Optional, the width of a grid item
        //fillEmptySpace: true // Optional, fill the bottom of each column with widths of flexible height ?? not working
    };

    $(document).ready(function(){

        loadData();

        loadUser();

        {% if followed %}
            $('#follow').hide()
        {% else %}
            $('#unfollow').hide()
        {% endif %}
        $('#follow').click(function(){
            $.get("{% url 'photo:user-follow' pk %}", {
            }, function(data, status, xhr) {
                if(data.redirect) return window.location.href = data.redirect;
                $('#follow').hide()
                $('#unfollow').show()
            }, 'json');
        });
        $('#unfollow').click(function(){
            $.get("{% url 'photo:user-unfollow' pk %}", {
            }, function(data, status, xhr) {
                if(data.redirect) return window.location.href = data.redirect;
                $('#follow').show()
                $('#unfollow').hide()
            }, 'json');
        });

    })



</script>

<!-- Include the imagesLoaded plug-in -->
<script src="{% static 'jquery.imagesloaded.min.js' %}"></script>

<!-- Include the plug-in -->
<script src="{% static 'jquery.wookmark.min.js' %}"></script>

<!-- Include the photo_load.js -->
<script src="{% static 'photo_load_grid.js' %}"></script>
<script src="{% static 'load_user.js' %}"></script>

{% endblock %}